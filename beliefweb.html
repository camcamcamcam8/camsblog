<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Structured Belief Web</title>
  <script src="https://d3js.org/d3.v7.min.js"></script>
  <style>
    body {
      margin: 0; 
      padding: 0;
      font-family: sans-serif;
      background-color: #f9f9f9;
    }
    h1, p {
      text-align: center;
      margin: 20px auto;
      max-width: 800px;
    }
    #chart {
      width: 100%;
      height: 800px; /* adjust height as needed */
      margin: 0 auto;
      background: #fff;
      border: 1px solid #ccc;
    }
    text {
      font-size: 0.85rem;
      fill: #333;
      pointer-events: none; /* so you can drag circles underneath text */
    }
    .core {
      fill: steelblue;
      stroke: #333;
      stroke-width: 1px;
    }
    .sub {
      fill: orange;
      stroke: #666;
      stroke-width: 0.5px;
    }
    line {
      stroke: #999;
      stroke-opacity: 0.6;
    }
    .coreLabel {
      font-weight: normal;
    }
    .subLabel {
      font-weight: bold;
    }
  </style>
</head>
<body>
  <h1>Structured Belief Web</h1>
  <p>
    Core beliefs are pinned in a circle at the center. Sub-beliefs float farther out,<br/>
    connected by longer link distances. Scroll/pinch to zoom, drag the background to pan.
  </p>

  <div id="chart"></div>

  <script>
    // -------------------------------------------
    // 1) DEFINE NODES (core pinned, subs free) & LINKS
    // -------------------------------------------
    const nodes = [
      // === CORE NODES (group:"core") ===
      { id: "Core1",  name: "(1) Universal Consciousness",         group: "core" },
      { id: "Core2",  name: "(2) Oneness & Interconnectedness",     group: "core" },
      { id: "Core3",  name: "(3) Societal Conditioning",            group: "core" },
      { id: "Core4",  name: "(4) Suffering from Resistance",        group: "core" },
      { id: "Core5",  name: "(5) Purpose & Greater Good",           group: "core" },
      { id: "Core6",  name: "(6) Universal Laws & Energy",          group: "core" },
      { id: "Core7",  name: "(7) Knowledge vs. Wisdom",             group: "core" },

      // === SUB-BELIEFS (group:"sub") ===
      // Core1
      { id: "1.1", name: "We Are Spiritual Beings Having a Human Experience", group: "sub" },
      { id: "1.2", name: "Death Is Not Truly an End",                         group: "sub" },
      { id: "1.3", name: "There Is a Divine Order Amidst Chaos",              group: "sub" },
      { id: "1.4", name: "Prayer or Intention-Setting Opens the Heart",       group: "sub" },
      { id: "1.5", name: "Stillness Reveals Inner Truth",                     group: "sub" },

      // Core2
      { id: "2.1", name: "Authentic Service Reflects Oneness",                group: "sub" },
      { id: "2.2", name: "Self-Forgiveness Is Key",                           group: "sub" },
      { id: "2.3", name: "Nothing External Can Truly Complete You",           group: "sub" },
      { id: "2.4", name: "Everyone Always Does What They Think Is Best",      group: "sub" },
      { id: "2.5", name: "Everyone's Value as a Human Is EQUAL",              group: "sub" },
      { id: "2.6", name: "You Don't Have to Earn What's Already Yours",       group: "sub" },

      // Core3
      { id: "3.1", name: "An Open Heart Is the Natural State",                group: "sub" },
      { id: "3.2", name: "Emotions Are Energetic Invitations",                group: "sub" },
      { id: "3.3", name: "The Human Mind Is a Tool, Not the Master",          group: "sub" },
      { id: "3.4", name: "Playfulness & Joy Are Sacred",                      group: "sub" },
      { id: "3.5", name: "Less Is More",                                      group: "sub" },
      { id: "3.6", name: "Good/Bad Are Perspectives, Not Absolutes",          group: "sub" },
      { id: "3.7", name: "Reality Is Not Binary; Our Minds Impose Categories",group: "sub" },

      // Core4
      { id: "4.1", name: "Acceptance Is Not Passivity",                       group: "sub" },
      { id: "4.2", name: "Higher Frequencies Expand Possibility",             group: "sub" },
      { id: "4.3", name: "Gratitude Is a Gateway to Love & Peace",            group: "sub" },
      { id: "4.4", name: "Feeling Is the Secret",                             group: "sub" },
      { id: "4.5", name: "Adversity Is a Portal to Awakening",                group: "sub" },
      { id: "4.6", name: "You Don't Need to Push Through Fearâ€”Stop Identifying with Its Source", group: "sub" },

      // Core5
      { id: "5.1", name: "The Kingdom of God/Enlightenment Is Within",        group: "sub" },
      { id: "5.2", name: "Nature Is a Gateway to the Divine",                 group: "sub" },
      { id: "5.3", name: "God/The Universe Works Through My Actions, Not in Place of Them", group: "sub" },

      // Core6
      { id: "6.1", name: "We Co-Create Reality with Consciousness",           group: "sub" },
      { id: "6.2", name: "Focus on the 'What'; Universe Takes Care of the 'How'", group: "sub" },
      { id: "6.3", name: "Becoming the Person Who Has X Is the True Way",     group: "sub" },
      { id: "6.4", name: "The Universe Is Constantly Offering Doors",         group: "sub" },
      { id: "6.5", name: "Manifestation Speed Reflects Certainty",            group: "sub" },
      { id: "6.6", name: "Internal Contradiction Is the Biggest Delay",       group: "sub" },
      { id: "6.7", name: "Speak & Act from Already Having It",               group: "sub" },
      { id: "6.8", name: "Every Intention Has an Energetic Charge",           group: "sub" },
      { id: "6.9", name: "Faith, Not Force, Accelerates Desire",              group: "sub" },

      // Core7
      { id: "7.1", name: "Presence Is the Ultimate Practice",                 group: "sub" },
      { id: "7.2", name: "Stillness Reveals Inner Truth",                     group: "sub" },
    ];

    // Each sub-belief links to its parent Core node
    const links = [
      // Core1
      { source: "1.1", target: "Core1" },
      { source: "1.2", target: "Core1" },
      { source: "1.3", target: "Core1" },
      { source: "1.4", target: "Core1" },
      { source: "1.5", target: "Core1" },
      // Core2
      { source: "2.1", target: "Core2" },
      { source: "2.2", target: "Core2" },
      { source: "2.3", target: "Core2" },
      { source: "2.4", target: "Core2" },
      { source: "2.5", target: "Core2" },
      { source: "2.6", target: "Core2" },
      // Core3
      { source: "3.1", target: "Core3" },
      { source: "3.2", target: "Core3" },
      { source: "3.3", target: "Core3" },
      { source: "3.4", target: "Core3" },
      { source: "3.5", target: "Core3" },
      { source: "3.6", target: "Core3" },
      { source: "3.7", target: "Core3" },
      // Core4
      { source: "4.1", target: "Core4" },
      { source: "4.2", target: "Core4" },
      { source: "4.3", target: "Core4" },
      { source: "4.4", target: "Core4" },
      { source: "4.5", target: "Core4" },
      { source: "4.6", target: "Core4" },
      // Core5
      { source: "5.1", target: "Core5" },
      { source: "5.2", target: "Core5" },
      { source: "5.3", target: "Core5" },
      // Core6
      { source: "6.1", target: "Core6" },
      { source: "6.2", target: "Core6" },
      { source: "6.3", target: "Core6" },
      { source: "6.4", target: "Core6" },
      { source: "6.5", target: "Core6" },
      { source: "6.6", target: "Core6" },
      { source: "6.7", target: "Core6" },
      { source: "6.8", target: "Core6" },
      { source: "6.9", target: "Core6" },
      // Core7
      { source: "7.1", target: "Core7" },
      { source: "7.2", target: "Core7" },
    ];

    // -------------------------------------------
    // 2) SET UP SVG + ZOOM/PAN
    // -------------------------------------------
    const width = document.getElementById("chart").clientWidth;
    const height = document.getElementById("chart").clientHeight;

    const svg = d3.select("#chart")
      .append("svg")
      .attr("width", width)
      .attr("height", height);

    const svgGroup = svg.append("g");

    // Zoom behavior
    const zoom = d3.zoom()
      .scaleExtent([0.3, 3])
      .on("zoom", (event) => {
        svgGroup.attr("transform", event.transform);
      });

    // Attach zoom to SVG, start slightly zoomed out
    svg.call(zoom).call(zoom.transform, d3.zoomIdentity.scale(0.85));

    // -------------------------------------------
    // 3) PIN CORE NODES IN A CIRCLE NEAR CENTER
    // -------------------------------------------
    function pinCoreNodes() {
      let centerX = width / 2;
      let centerY = height / 2;
      let radius = 120; // radius of the circle where cores will be placed
      let angleStep = (2 * Math.PI) / 7; // 7 cores
      let i = 0;

      nodes.forEach(n => {
        if (n.group === "core") {
          let angle = i * angleStep;
          n.fx = centerX + radius * Math.cos(angle);
          n.fy = centerY + radius * Math.sin(angle);
          i++;
        }
      });
    }
    pinCoreNodes();

    // -------------------------------------------
    // 4) CREATE FORCE SIMULATION
    // -------------------------------------------
    const simulation = d3.forceSimulation(nodes)
      // bigger link distance so sub-beliefs spread out more
      .force("link", d3.forceLink(links).id(d => d.id).distance(180))
      // reduce repulsion to avoid extreme scattering
      .force("charge", d3.forceManyBody().strength(-160))
      // center force helps keep sub-beliefs from drifting away
      .force("center", d3.forceCenter(width / 2, height / 2))
      // slight collision
      .force("collide", d3.forceCollide(40));

    // -------------------------------------------
    // 5) DRAW LINKS (lines)
    // -------------------------------------------
    const link = svgGroup.selectAll("line")
      .data(links)
      .enter()
      .append("line")
      .attr("stroke-width", 1);

    // -------------------------------------------
    // 6) DRAW NODES (circles)
    // -------------------------------------------
    const node = svgGroup.selectAll("circle")
      .data(nodes)
      .enter()
      .append("circle")
      .attr("r", d => d.group === "core" ? 15 : 8)
      .attr("class", d => d.group)
      .call(d3.drag()
        .on("start", dragstarted)
        .on("drag", dragged)
        .on("end", dragended)
      );

    // -------------------------------------------
    // 7) DRAW LABELS (text)
    // -------------------------------------------
    const label = svgGroup.selectAll("text")
      .data(nodes)
      .enter()
      .append("text")
      .text(d => d.name)
      .attr("x", 8)
      .attr("y", 3)
      .attr("class", d => d.group === "sub" ? "subLabel" : "coreLabel");

    // -------------------------------------------
    // 8) TICK FUNCTION
    // -------------------------------------------
    simulation.on("tick", () => {
      link
        .attr("x1", d => d.source.x)
        .attr("y1", d => d.source.y)
        .attr("x2", d => d.target.x)
        .attr("y2", d => d.target.y);

      node
        .attr("cx", d => d.x)
        .attr("cy", d => d.y);

      label
        .attr("x", d => d.x + 10)
        .attr("y", d => d.y + 3);
    });

    // -------------------------------------------
    // 9) DRAG FUNCTIONS
    // -------------------------------------------
    function dragstarted(event, d) {
      if (!event.active) simulation.alphaTarget(0.3).restart();
      // sub-beliefs can be moved, but let's keep core nodes pinned
      if (d.group === "sub") {
        d.fx = d.x;
        d.fy = d.y;
      }
    }

    function dragged(event, d) {
      if (d.group === "sub") {
        d.fx = event.x;
        d.fy = event.y;
      }
    }

    function dragended(event, d) {
      if (!event.active) simulation.alphaTarget(0);
      // if it's a sub-belief, let it float after drag
      if (d.group === "sub") {
        d.fx = null;
        d.fy = null;
      }
    }
  </script>
</body>
</html>
